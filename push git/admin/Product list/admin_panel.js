// const productList = [
//   {
//     id: 1,
//     name: "FRUIT CAKE",
//     img: "./img/gaute-1.png",
//     categories: "Gateaux Kem Tươi",
//     price: "275,000đ",
//     stock: 10,
//     status: "On stock",
//     description: `
//     Thành phần chính:

// - Gato

// - Kem tươi vị rượu rum

// - Hoa quả

// - Dừa khô.

// Bánh làm từ 3 lớp gato trắng xen giữa 3 lớp kem tươi vị rượu rum (nho). Trên mặt bánh được trang trí bằng hoa quả với dừa khô kết xung quanh.`,
//   },
//   {
//     id: 2,
//     name: "CAPUCCINO",
//     img: "./img/gaute-2.png",
//     categories: "Gateaux Kem Tươi",
//     price: "275,000đ",
//     stock: 10,
//     status: "On stock",
//     description: `
//     Thành phần chính:

// - Gato

// - Kem phomai vị coffee

// - Cacao.

// Bánh làm từ 3 lớp gato TRẮNG xen giữa 3 lớp kem TƯƠI PHOMAI, VỊ COFFEE. Bên ngoài phủ 1 lớp bột cacao VÀ DECOR HOA QUẢ. `,
//   },
//   {
//     id: 3,
//     name: "COCONUT CAKE",
//     img: "./img/gaute-3.png",
//     categories: "Gateaux Kem Tươi",
//     price: "275,000đ",
//     stock: 10,
//     status: "On stock",
//     description: `
//     Thành phần chính:

// Gato
// Kem tươi  vị Coffee
// Dừa tươi sấy khô
// Bánh làm từ 3 lớp kem gato trắng  kết hợp với 3 lớp kem TƯƠI  vị coffe.bánh được phủ bên ngoài bởi 1 lớp dừa sấy khô rất thơm , TRANG TRÍ HOA QUẢ`,
//   },
//   {
//     id: 4,
//     name: "GREENTEA CAKE",
//     img: "./img/gaute-4.png",
//     categories: "Gateaux Kem Tươi",
//     price: "275,000đ",
//     stock: 10,
//     status: "On stock",
//     description: `
//     Thành phần chính:

// - Gato,

// - Kem tươi trà xanh ,  vị rượu rum,

// -Bột Trà xanh.

// Bánh làm từ 3 lớp gato trắng xen giữa 3 lớp kem tươi trà xanh  vị rượu rum (nho). Bên ngoài bánh phủ 1 LỚP BỘT TRÀ XANH VÀ TRANG TRÍ HOA QUẢ.`,
//   },
//   {
//     id: 5,
//     name: "FRUIT CAKE",
//     img: "./img/gaute-kem-bo-1.png",
//     categories: "Gateaux Kem Bơ",
//     price: "300,000đ",
//     stock: 10,
//     status: "On stock",
//     description: `
//     Thành phần chính:

// - Gato

// - Kem BƠ COFFEE

// Bánh làm từ 3 lớp gato trắng xen giữa 3 lớp kem BƠ COFFEE, VỊ COFFEE. Trên mặt bánh được trang trí bằng hoa quả và socola đổ .`,
//   },
//   {
//     id: 6,
//     name: "DARK CHOCOLATE COCONUT",
//     img: "./img/gaute-kem-bo-2.png",
//     categories: "Gateaux Kem Bơ",
//     price: "300,000đ",
//     stock: 10,
//     status: "On stock",
//     description: `
//     Thành phần chính:

// - Gato,

// - Kem bơ trộn socola vị rượu rum,

// - Dừa khô.

// Bánh làm từ 3 lớp gato xen giữa 3 lớp kem. Phủ bằng 1 lớp gato trộn socola vị rượu rum với dừa khô và socola rắc ngoài.
//   `,
//   },
//   {
//     id: 7,
//     name: "DARK CHOCOLATE CAKE",
//     img: "./img/gaute-kem-bo-3.png",
//     categories: "Gateaux Kem Bơ",
//     price: "300,000đ",
//     stock: 10,
//     status: "On stock",
//     description: `
//     Thành phần chính:

// - Gato,

// - Kem bơ vị rượu rum,

// - Socola.

// Bánh được làm từ 3 lớp gato xen giữa 3 lớp kem. Kế tiếp là lớp kem bơ socola vị rượu rum và 1 lớp socola chảy phủ bên ngoài.
//   `,
//   },
//   {
//     id: 8,
//     name: "DARK STRAW CHOCO CAKE",
//     img: "./img/gaute-kem-bo-4.png",
//     categories: "Gateaux Kem Bơ",
//     price: "300,000đ",
//     stock: 10,
//     status: "On stock",
//     description: `
//     THÀNH PHẦN CHÍNH:
// - GATO
// - KEM BƠ VỊ RƯỢU RUM
// - SOCOLA BÀO ĐEN
// BÁNH ĐƯỢC LÀM TỪ 3 LỚP GATO TRẮNG XEN KẼ 3 LỚP KEM BƠ PHA CHOCOLATE, VỊ RƯỢU RUM , PHỦ BÊN NGOÀI LÀ MỘT LỚP CHOCOLATE BÀO ĐEN NGUYÊN CHẤT VÀ TRANG TRÍ HOA QUẢ.
//   `,
//   },
//   {
//     id: 9,
//     name: "TIRAMISU CAKE MOUSSE",
//     img: "./img/birthday-cake-1.png",
//     categories: "Bánh Sinh Nhật 2024",
//     price: "300,000đ",
//     stock: 10,
//     status: "On stock",
//     description: `
//     THÀNH PHẦN CHÍNH:
// - GATO
// - KEM BƠ VỊ RƯỢU RUM
// - SOCOLA BÀO ĐEN
// BÁNH ĐƯỢC LÀM TỪ 3 LỚP GATO TRẮNG XEN KẼ 3 LỚP KEM BƠ PHA CHOCOLATE, VỊ RƯỢU RUM , PHỦ BÊN NGOÀI LÀ MỘT LỚP CHOCOLATE BÀO ĐEN NGUYÊN CHẤT VÀ TRANG TRÍ HOA QUẢ.
//   `,
//   },
//   {
//     id: 10,
//     name: "TIRAMISU CAKE MOUSSE",
//     img: "./img/birthday-cake-2.png",
//     categories: "Bánh Sinh Nhật 2024",
//     price: "300,000đ",
//     stock: 10,
//     status: "On stock",
//     description: `
// - GATO
// - CREAM CHEESE PHOMAI
// BÁNH ĐƯỢC LÀM TỪ 3 LỚP GATO KẾT HỢP VỚI LỚP CREAM CHEESE , PHOMAI. PHỦ MẶT BÁNH 1 LỚP BỘT CACAO VÀ TRANG TRÍ HOA QUẢ.F10
//   `,
//   },
//   {
//     id: 11,
//     name: "TIRAMISU CAKE CHỮ NHẬT",
//     img: "./img/birthday-cake-3.png",
//     categories: "Bánh Sinh Nhật 2024",
//     price: "300,000đ",
//     stock: 10,
//     status: "On stock",
//     description: `
//     - Gato,
// - Kem tươi mặn vị coffee.
// Bánh làm từ 3 lớp gato trắng kết hợp với 3 lớp kem mặn vị coffee. Bánh phủ bên ngoài bởi 1 lớp kem tươi trắng rắc bột cacao.
//   `,
//   },
//   {
//     id: 12,
//     name: "TIRAMISU CAKE MOUSSE 1",
//     img: "./img/birthday-cake-4.png",
//     categories: "Bánh Sinh Nhật 2024",
//     price: "300,000đ",
//     stock: 10,
//     status: "On stock",
//     description: `
//     - Gato,
// - Kem tươi mặn vị coffee.
// Bánh làm từ 3 lớp gato trắng kết hợp với 3 lớp kem mặn vị coffee. Bánh phủ bên ngoài bởi 1 lớp kem tươi trắng rắc bột cacao.
//   `,
//   },
//   {
//     id: 13,
//     name: "BÁNH SỐ 1",
//     img: "./img/num-cake-1.jpeg",
//     categories: "BÁNH SỐ",
//     price: "400,000đ",
//     stock: 10,
//     status: "On stock",
//     description: `
//     Thành phần chính:

// - Kem bơ

// - Socola trắng

// - Hoa quả

// Bánh làm từ 3 lớp gato trắng xen giữa 3 lớp kem tươi vị rượu rum (nho), bên trên phủ 1 lớp socola trắng bào và trang trí bằng hoa quả.
//   `,
//   },
//   {
//     id: 14,
//     name: "BÁNH SỐ 2",
//     img: "./img/num-cake-2.jpeg",
//     categories: "BÁNH SỐ",
//     price: "400,000đ",
//     stock: 10,
//     status: "On stock",
//     description: `
//     Thành phần chính:

// - Kem bơ

// - Socola trắng

// - Hoa quả

// Bánh làm từ 3 lớp gato trắng xen giữa 3 lớp kem tươi vị rượu rum (nho), bên trên phủ 2 lớp socola trắng bào và trang trí bằng hoa quả.
//   `,
//   },
//   {
//     id: 15,
//     name: "BÁNH SỐ 3",
//     img: "./img/num-cake-3.jpeg",
//     categories: "BÁNH SỐ",
//     price: "400,000đ",
//     stock: 10,
//     status: "On stock",
//     description: `
// Thành phần chính:

// - Kem bơ

// - Socola trắng

// - Hoa quả

// Bánh làm từ 3 lớp gato trắng xen giữa 3 lớp kem tươi vị rượu rum (nho), bên trên phủ 3 lớp socola trắng bào và trang trí bằng hoa quả.
//   `,
//   },
//   {
//     id: 16,
//     name: "BÁNH SỐ 4",
//     img: "./img/num-cake-4.jpeg",
//     categories: "BÁNH SỐ",
//     price: "400,000đ",
//     stock: 10,
//     status: "On stock",
//     description: `
//     Thành phần chính:

// - Kem bơ

// - Socola trắng

// - Hoa quả

// Bánh làm từ 3 lớp gato trắng xen giữa 3 lớp kem tươi vị rượu rum (nho), bên trên phủ 4 lớp socola trắng bào và trang trí bằng hoa quả.
//   `,
//   },
//   {
//     id: 17,
//     name: "BÁNH NGÀN LỚP TÁO - PUFF PASTRY APPLE PIES",
//     img: "./img/banh-mi-1.jpeg",
//     categories: "BÁNH MÌ",
//     price: "15,000đ",
//     stock: 10,
//     status: "On stock",
//     description: `
//     Thành phần:

// - Bột mỳ

// - Bơ

// - Đường

// - Kem

// - Táo xào

// - Hạt Almon
//   `,
//   },
//   {
//     id: 18,
//     name: "BÁNH LỚP NHÂN CHUỐI DỪA",
//     img: "./img/banh-mi-2.jpeg",
//     categories: "BÁNH MÌ",
//     price: "18,000đ",
//     stock: 10,
//     status: "On stock",
//     description: `
//     Bột mì, men, muối, đường, bơ, trứng, phụ gia, chuối, cơm dừa.
//   `,
//   },
//   {
//     id: 19,
//     name: "BÁNH MÌ MỀM NHÂN NHO DỪA",
//     img: "./img/banh-mi-3.jpeg",
//     categories: "BÁNH MÌ",
//     price: "22,000đ",
//     stock: 10,
//     status: "On stock",
//     description: `
//     Bột mì, men, muối, đường, trứng, sữa đặc, kem whipping, bơ, dừa tươi, nho khô.
//   `,
//   },

//   {
//     id: 20,
//     name: "PAIN CHOCOLATE",
//     img: "./img/banh-mi-4.jpeg",
//     categories: "BÁNH MÌ",
//     price: "18,000đ",
//     stock: 10,
//     status: "On stock",
//     description: `
//     Thành phần chính:

// - Bột mỳ

// - Bơ

// - Socola

// - Phụ gia
//   `,
//   },
//   {
//     id: 21,
//     name: "PIZZA MINI",
//     img: "./img/banh-man-1.jpeg",
//     categories: "BÁNH MẶN",
//     price: "10,000đ",
//     stock: 10,
//     status: "On stock",
//     description: `
//     Thành phần chính:

// - Bột mỳ

// - Dầu ăn

// - Phomai

// - Thịt Jambong
//   `,
//   },
//   {
//     id: 22,
//     name: "BÁNH XÚC XÍCH HOA",
//     img: "./img/banh-man-2.jpeg",
//     categories: "BÁNH MẶN",
//     price: "28,000đ",
//     stock: 10,
//     status: "On stock",
//     description: `
//     Thàn phần:

// - Bột mỳ

// - Ruốc

// - Sốt

// - Xúc xích

// - Muối

// - Phụ gia
//   `,
//   },
//   {
//     id: 23,
//     name: "BÁNH MÌ SỐT THỊT BẰM ĐÀI LOAN",
//     img: "./img/banh-man-3.jpeg",
//     categories: "BÁNH MẶN",
//     price: "30,000đ",
//     stock: 10,
//     status: "On stock",
//     description: `
//     Bột mì, men, muối, đường, sữa tươi, bơ, trứng, bột chiên xù, tỏi, thịt xay, cà rốt, hạt tiêu, bột ngô, trứng muối, phomai mozzarella
//   `,
//   },
//   {
//     id: 24,
//     name: "BÁNH MÌ CÁ NGỪ SỐT TOMYUM THÁI",
//     img: "./img/banh-man-4.jpeg",
//     categories: "BÁNH MẶN",
//     price: "30,000đ",
//     stock: 10,
//     status: "On stock",
//     description: `Bột mì, men, muối, phụ gia, đường, sữa tươi, bơ, trứng, cà rốt, hành tây, cá ngừ, sốt tomyum, hạt tiêu, sốt mayonnaise, phomai mozzarella.
//   `,
//   },
//   {
//     id: 25,
//     name: "MUFFIN VANI",
//     img: "./img/cookie-1.jpeg",
//     categories: "COOKIE",
//     price: "15,000đ",
//     stock: 10,
//     status: "On stock",
//     description: `
//     Thành phần:

// - Gato vị vani

// - Hạnh nhân cắt lát
//   `,
//   },
//   {
//     id: 26,
//     name: "SOCOLA 1",
//     img: "./img/cookie-2.jpeg",
//     categories: "COOKIE",
//     price: "6,000đ",
//     stock: 10,
//     status: "On stock",
//     description: `
//   `,
//   },
//   {
//     id: 27,
//     name: "SOCOLA 2",
//     img: "./img/cookie-3.jpeg",
//     categories: "COOKIE",
//     price: "6,000đ",
//     stock: 10,
//     status: "On stock",
//     description: `
//     Socola đen, socola trắng, kem whipping, bơ, mật ong, hương bạc hà.
//   `,
//   },

//   {
//     id: 28,
//     name: "COOKIES YẾN MẠCH",
//     img: "./img/cookie-4.jpeg",
//     categories: "COOKIE",
//     price: "300,000đ",
//     stock: 10,
//     status: "On stock",
//     description: `
//     Bột mì, bơ, trứng, hạt yến mạch, đường, muối
//   `,
//   },
//   {
//     id: 29,
//     name: "MUFFIN SOCOLA",
//     img: "./img/mini-1.jpeg",
//     categories: "MINI",
//     price: "15,000đ",
//     stock: 10,
//     status: "On stock",
//     description: `
//     Thành phần:

// - Gato vị socola

// - Hạnh nhân cắt lát
//   `,
//   },
//   {
//     id: 30,
//     name: "MUFFIN TRỨNG MUỐI",
//     img: "./img/mini-2.jpeg",
//     categories: "MINI",
//     price: "20,000đ",
//     stock: 10,
//     status: "On stock",
//     description: `
//     Thành phần:

// - Gato

// - Trứng muối

// - Ruốc
//   `,
//   },
//   {
//     id: 31,
//     name: "BÁNH CUỘN CA CAO",
//     img: "./img/mini-3.jpeg",
//     categories: "MINI",
//     price: "75,000đ",
//     stock: 10,
//     status: "On stock",
//     description: `
//     Bột mỳ, trứng, đường, sữa tươi, dầu ăn, bột sữa, kem bơ, bột ca cao.
//   `,
//   },
//   {
//     id: 32,
//     name: "BÁNH SU DAI KEM PHOMAI",
//     img: "./img/mini-4.jpeg",
//     categories: "MINI",
//     price: "13,000đ",
//     stock: 10,
//     status: "On stock",
//     description: `
//     -Bột mì, trứng, dầu ăn, kem cheese
//   `,
//   },
// ];

// const dbproductList =
//   localStorage.setItem("dbproductList", JSON.stringify(dbproductList)) || [];
const addBtn = document.querySelector(".add");
// display cái form ra
const form = document.querySelector(".add-form");
const addInForm = document.querySelector("#addp-btn");
console.log(addInForm);
let cancelInForm = document.querySelector("#cancel-btn");
let sortCate = document.getElementById("select-cate");
const tbody = document.querySelector("#product-list-tbody");
// ==================================================
function renderProductList() {
  let dbproductList =
    JSON.parse(window.localStorage.getItem("dbproductList")) || [];
  //   console.log(dbproductList);
  //   let currentPage = 1;
  //   let totalPage = Math.ceil(dbproductList.length / 5);
  //   let skip = (currentPage - 1) * 5;
  //   dbproductList = dbproductList.slice(skip, skip + 5);
  //   const pageControl = document.querySelector(".page");
  //   for (let i = 1; i <= i + 5; i++) {
  //     pageControl.innerHTML += `
  // <button class="pagination" id="${i}">${i}</button>
  // `;
  //   }
  //
  //   Filter
  switch (sortCate.value) {
    case "All":
      dbproductList = dbproductList;
      break;
    case "Gateaux Kem Tươi":
      dbproductList = dbproductList.filter(
        (e) => e.categories.toLowerCase() == "Gateaux Kem Tươi".toLowerCase()
      );
      break;
    case "Gateaux Kem Bơ":
      dbproductList = dbproductList.filter(
        (e) => e.categories.toLowerCase() == "Gateaux Kem Bơ".toLowerCase()
      );
      break;

    case "Bánh Sinh Nhật 2024":
      dbproductList = dbproductList.filter(
        (e) => e.categories.toLowerCase() == "Bánh Sinh Nhật 2024".toLowerCase()
      );
      break;
    case "BÁNH SỐ":
      dbproductList = dbproductList.filter(
        (e) => e.categories.toLowerCase() == "BÁNH SỐ".toLowerCase()
      );
      break;
    case "BÁNH MÌ":
      dbproductList = dbproductList.filter(
        (e) => e.categories.toLowerCase() == "BÁNH MÌ".toLowerCase()
      );
      break;
    case "BÁNH MẶN":
      dbproductList = dbproductList.filter(
        (e) => e.categories.toLowerCase() == "BÁNH MẶN".toLowerCase()
      );
      break;
    case "COOKIE":
      dbproductList = dbproductList.filter(
        (e) => e.categories.toLowerCase() == "COOKIE".toLowerCase()
      );
      break;
    case "MINI":
      dbproductList = dbproductList.filter(
        (e) => e.categories.toLowerCase() == "MINI".toLowerCase()
      );
      break;
    default:
      dbproductList = dbproductList;
      break;
  }

  //   if (sort.value == "az") {
  //     dbCate.sort((a, b) => a.name.localeCompare(b.name));
  //   } else {
  //     dbCate.sort((a, b) => b.name.localeCompare(a.name));
  //   }
  let stringHTML = "";
  for (let i = 0; i < dbproductList.length; i++) {
    stringHTML += `
<tr>
    
    <td>${dbproductList[i].id}</td>
     <td>${dbproductList[i].name}</td>
    <td class="pic">
      <img src="${dbproductList[i].img}" alt="" />
    </td>
    <td>${dbproductList[i].categories}</td>
    <td>${dbproductList[i].price}</td>
    <td>${dbproductList[i].stock}</td>
    <td>${dbproductList[i].status}</td>
    <td class="btn-action">
      <button id="update-product-btn" onclick="updateProduct(${dbproductList[i].id})">Update</button>
      <button id="delete-product-btn" onclick="deleteProduct(${dbproductList[i].id})">Delete</button>
    </td>
</tr>
<tr>
<td colspan="8"><hr></td>
</tr>
`;
  }
  tbody.innerHTML = stringHTML;
}
renderProductList();
// ==================THEM SUA XOA SAN PHAM BANG ADD-FORM============================

// window.getComputedStyle(sqr[0]).backgroundColor;
//
// =====================PHÂN TRANG=========================

// let currentPage = 1;
// let dbproductList =
//   JSON.parse(window.localStorage.getItem("dbproductList")) || [];
// // window.localStorage.setItem("current-page", JSON.stringify(currentPage)) || [];
// let totalPage = Math.ceil(dbproductList.length / 5);
// let skip = (currentPage - 1) * 5;
// dbproductList = dbproductList.slice(skip, skip + 5);

// renderProductList();

// const pageControl = document.querySelector(".page");
// for (let i = 1; i <= i + 5; i++) {
//   pageControl.innerHTML += `
// <button class="pagination" id="${i}">${i}</button>
// `;
// }
// =======================================================
// 4_ADD FORM==========================

// 4.1_ADD BTN===========================
// lấy cái nút ra

addBtn.addEventListener("click", function () {
  form.style.display = "block";
});
//Change anh
// const inputImage = document.getElementById("img-product-add");
// inputImage.addEventListener("change", (e) => {
//   const file = e.target.files[0];
//   const reader = new FileReader();
//   reader.onloadend = function () {
//     document.getElementById("img-product-add").src = reader.result;
//   };
//   reader.readAsDataURL(file);
// });
//FUNCTION ADD FORM
const inputImage = document.getElementById("img-product-add");
let url;
inputImage.addEventListener("change", (e) => {
  const file = e.target.files[0];
  const reader = new FileReader();
  reader.onloadend = function () {
    url = reader.result;
    document.getElementById("img-product-add").src = reader.result;
  };
  reader.readAsDataURL(file);
});

function addProduct() {
  const dbproductList =
    JSON.parse(window.localStorage.getItem("dbproductList")) || [];
  console.log(dbproductList);
  //   VALIDATE DU LIEU bi sai cho nay

  //   TAO OBJECT MOI
  const newProduct = {
    id: dbproductList.length + 1,
    name: document.getElementById("name-product-add").value,
    img: url,
    categories: document.getElementById("categories-product-add").value,
    price: document.getElementById("price-product-add").value,
    stock: document.getElementById("stock-product-add").value,
    status: "On Stock",
    description: `
                ${document.getElementById("description-product-add").value}
              `,
  };
  //   console.log(newProduct);
  //   // CHEN VAO MANG dbProductList
  dbproductList.push(newProduct);
  window.localStorage.setItem("dbproductList", JSON.stringify(dbproductList));
  form.style.display = "none";
  renderProductList();
}
// 4.2CANCEL BTN===========================
//FUNCTION CANCEL FORM
// cancelInForm.addEventListener("click", function () {
//   form.style.display = "none";
// });

// 1_SEARCH BTN===========================
function search() {
  renderProductList();
}
search();
// 2_FILTER===========================
// SORT===========================
sortCate.addEventListener("change", function () {
  console.log(sortCate.value.toLowerCase());
  renderProductList();
});
// 3_SEE ALL===========================
function seeAll() {
  const dbproductList =
    JSON.parse(window.localStorage.getItem("dbproductList")) || [];
  sortCate.value = "All";
  renderProductList();
}
// 5_DELETE===========================
// const deleteProduct = document.getElementById("delete-product-btn");
// console.log(deleteProduct);
// const updateProduct = document.getElementById("update-product-btn");

function deleteProduct(id) {
  const dbproductList =
    JSON.parse(window.localStorage.getItem("dbproductList")) || [];
  let findIndex = dbproductList.findIndex((cate) => cate.id == id);
  dbproductList.splice(findIndex, 1);
  window.localStorage.setItem("dbproductList", JSON.stringify(dbproductList));
  renderProductList();
}
